function submitSudoku(){var n=[];isIncomplete()&&n.push("Incomplete");isInvalid()&&n.push("Invalid");n.length===1?createAlert("danger",n[0]):n.length>1?createAlert("danger",n.join("<br>")):$.ajax({url:"/Home/SubmitSolution",type:"POST",data:{sudoku:getGrid()},success:function(n){var i;if($("#body").html(n),updateTimer(),$("#alert").hasClass("alert-success")){$("#playButton").addClass("disabled");pauseTimer();var r=minutes+":"+(seconds<10?"0"+seconds:seconds),u=Math.sqrt($(".cell").length),t=1;difficulty==="Easy"?t=.5:difficulty==="Hard"?t=2:difficulty==="Expert"&&(t=4);i=Math.pow(u,4)-(minutes*60+seconds+moves*2+hints*4)/t;$("#stats").html("<br>Time: "+r+"<br>Moves: "+moves+"<br>Hints: "+hints+"<br>Difficulty modifier: x"+t+"<br><b>Score: "+i+"<\/b>")}setCellSize();addEventListeners();updateButtons()},error:function(n){console.log(n)}})}function solveSudoku(){var n=[];isInvalid()&&n.push("Invalid");n.length===1?createAlert("danger",n[0]):n.length>1?createAlert("danger",n.join("<br>")):$.ajax({url:"/Home/SolveSudoku",type:"POST",data:{sudoku:getGrid()},success:function(n){$("#body").html(n);setCellSize();addEventListeners();updateButtons()},error:function(n){console.log(n)}})}function setCellSize(){var n=$(".cell").width();$(".cell").each(function(){$(this).css("height",n+"px");$(this).css("font-size",n*.75+"px");$(this).css("line-height",n+"px")})}function addEventListeners(){window.addEventListener("resize",setCellSize);$(".cell").each(function(){$(this).on({mouseenter:function(){$(this).hasClass("selected")||($(this).hasClass("invalid")?$(this).css("background-color","#ffb4a9"):$(this).hasClass("highlighted")?$(this).css("background-color","#bbb"):$(this).css("background-color","#e1e1e1"))},mouseleave:()=>$(this).css("background-color",""),click:function(){selectedCell=this;highlightCells();updateButtons()}})});$("[id^='keypadButton']").each(function(){$(this).click(function(){$(selectedCell).text()===$(this).text()?updateCell(""):updateCell($(this).text())})});$("#hintButton").click(function(){updateCell($(selectedCell).data("solution"));hints++});$("#undoButton").click(()=>undo());$("#eraseButton").click(()=>updateCell(""));$("#submitButton").click(()=>mode==="generate"?submitSudoku():solveSudoku())}function updateButtons(){var n=$(selectedCell).data("editable")==="True";($("[id^='keypadButton']").each(function(){$(selectedCell).text()===$(this).text()?$(this).addClass("focus"):$(this).removeClass("focus")}),$(".board").data("solved")!=="True")&&($("[id^='keypadButton']").prop("disabled",!n),$("#hintButton").prop("disabled",mode==="solve"||!n),$("#eraseButton").prop("disabled",!n||$(selectedCell).text()===""),$("#undoButton").prop("disabled",undoStack.length===0),$("#submitButton").prop("disabled",!1))}function highlightCells(){var n=!1,t=!1,i=!1;$(selectedCell).text()!==""&&$(".cell").each(function(){if(this===selectedCell||$(this).text()!==$(selectedCell).text())return!0;$(this).data("region")===$(selectedCell).data("region")?n=!0:$(this).data("x")===$(selectedCell).data("x")?t=!0:$(this).data("y")===$(selectedCell).data("y")&&(i=!0)});$(".cell").each(function(){if($(this).css("background-color",""),$(this).removeClass("highlighted selected invalid"),this===selectedCell){if($(this).addClass("selected"),$(selectedCell).text()==="")return!0;(n||t||i)&&$(this).addClass("invalid")}else if($(this).data("region")===$(selectedCell).data("region")||$(this).data("x")===$(selectedCell).data("x")||$(this).data("y")===$(selectedCell).data("y")){if($(this).addClass("highlighted"),$(selectedCell).text()==="")return!0;(n&&$(this).data("region")===$(selectedCell).data("region")||t&&$(this).data("x")===$(selectedCell).data("x")||i&&$(this).data("y")===$(selectedCell).data("y"))&&$(this).addClass("invalid")}})}function updateCell(n){$(selectedCell).data("editable")==="True"&&(undoStack.push([$(selectedCell).data("x"),$(selectedCell).data("y"),$(selectedCell).text()]),$(selectedCell).text(n),moves++,highlightCells(),identifyInvalidCells(),updateButtons())}function identifyInvalidCells(){$(".cell").each(function(){var n=this,i=$(n).data("editable")==="True",t=!1;$(n).removeClass(function(n,t){return(t.match(/(^|\s)text-\S+/g)||[]).join(" ")});$(this).text()!==""&&$(".cell").each(function(){return t=this!==n&&$(this).text()===$(n).text()&&($(this).data("region")===$(n).data("region")||$(this).data("x")===$(n).data("x")||$(this).data("y")===$(n).data("y")),!t});t?$(n).addClass("text-danger"):i&&$(n).addClass("text-primary")})}function undo(){var n=undoStack.pop();$('.cell[data-x="'+n[0]+'"][data-y="'+n[1]+'"]').text(n[2]);moves++;highlightCells();identifyInvalidCells();updateButtons()}function isIncomplete(){var n=!1;return $(".cell").each(function(){if($(this).text()==="")return n=!0,!1}),n}function isInvalid(){var n=!1;return $(".cell").each(function(){if($(this).hasClass("text-danger"))return n=!0,!1}),n}function getGrid(){var n=[];return $(".cell").each(function(){n.push($(this).text())}),n}function createAlert(n,t){$("#alertContainer").html("<div class='alert alert-dismissible alert-"+n+"'><a href='#' class='close' data-dismiss='alert'>&times;<\/a>"+t+"<\/div>")}function startTimer(){$("#playButton").hasClass("disabled")||(timer||(timer=setInterval(updateTimer,1e3)),$("#playButton").attr("hidden",!0),$("#pauseButton").removeAttr("hidden"))}function updateTimer(){$("#time").text(minutes+":"+(seconds<10?"0"+seconds:seconds));seconds++;seconds===60&&(seconds=0,minutes++)}function pauseTimer(){clearInterval(timer);timer=!1;$("#pauseButton").attr("hidden",!0);$("#playButton").removeAttr("hidden")}function resetTimer(){pauseTimer();seconds=0;minutes=0}var difficulty,mode,selectedCell,undoStack=[],timer,seconds=0,minutes=0,moves=0,hints=0;$(function(){var t=$("#slider"),n=$("#size"),i=[4,6,8,9,10,12,14,15,16];t.attr("max",i.length-1);t.val(3);n.text("Size: 9x9");t.on("input",function(){n.text("Size: "+i[this.value]+"x"+i[this.value])});$("input[name='mode']").click(function(){$("#difficulty").prop("disabled",$(this).val()==="solve"?!0:!1)});$("#newSudoku").submit(function(t){t.preventDefault();difficulty=$("#difficulty").val();mode=$("input[name='mode']:checked").val();$.ajax({url:"/Home/NewSudoku",type:"POST",data:{difficulty:difficulty,size:n.text().substring(5,n.text().length).split("x")[0],mode:mode},success:function(n){selectedCell=null;undoStack=[];resetTimer();moves=0;hints=0;$("#body").html(n);setCellSize();addEventListeners();updateButtons();$("#playButton").removeClass("disabled");mode==="solve"?$("#playButton").addClass("disabled"):startTimer()},error:function(){alert("error")}})});setCellSize()});